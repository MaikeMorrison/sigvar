<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Statistically compare the within-sample diversity and across-sample heterogeneity of the mutational signature activity in two or more groups of tumor samples. — sigboot • sigvar</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Statistically compare the within-sample diversity and across-sample heterogeneity of the mutational signature activity in two or more groups of tumor samples. — sigboot"><meta property="og:description" content="sigboot uses bootstrapping to evaluate differences in within-sample diversity and across-sample heterogeneity of mutational signature activity  between pairs of groups of tumor samples. sigboot takes the same options as sigvar, so, as with sigvar, you can separately analyze multiple populations or groups of samples (specify group), and account for cosine similarity among signatures (specify S). sigboot follows the bootstrapping procedure defined by Efron and Tibshirani (1993). Details on the bootstrapping procedure are available in the Methods section of the accompanying paper."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sigvar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/geography_incidence_figure.html">sigvar analysis of Mutographs data</a>
    </li>
    <li>
      <a href="../articles/tutorial.html">Introduction to Signature Variability Analysis with sigvar</a>
    </li>
    <li>
      <a href="../articles/carcinogen_figure.html">sigvar analysis of samples with varying carcinogen exposure</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/MaikeMorrison/sigvar/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Statistically compare the within-sample diversity and across-sample heterogeneity of the mutational signature activity in two or more groups of tumor samples.</h1>
    <small class="dont-index">Source: <a href="https://github.com/MaikeMorrison/sigvar/blob/HEAD/R/bootstrap.R" class="external-link"><code>R/bootstrap.R</code></a></small>
    <div class="hidden name"><code>sigboot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>sigboot</code> uses bootstrapping to evaluate differences in within-sample diversity and across-sample heterogeneity of mutational signature activity  between pairs of groups of tumor samples. <code>sigboot</code> takes the same options as <code>sigvar</code>, so, as with <code>sigvar</code>, you can separately analyze multiple populations or groups of samples (specify <code>group</code>), and account for cosine similarity among signatures (specify <code>S</code>). <code>sigboot</code> follows the bootstrapping procedure defined by Efron and Tibshirani (1993). Details on the bootstrapping procedure are available in the Methods section of the accompanying paper.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sigboot</span><span class="op">(</span></span>
<span>  <span class="va">sig_activity</span>,</span>
<span>  <span class="va">n_replicates</span>,</span>
<span>  K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sig_activity</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  S <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_replicates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sig_activity</dt>
<dd><p>A matrix or data frame with rows containing non-negative entries that sum to 1. Each row represents a sample, each column represents a mutational signature, and each entry represents the abundance of that signature in the sample. If <code>sig_activity</code> contains any metadata, it must be on the left-hand side of the matrix, the right <code>K</code> entries of each row must sum to 1, and <code>K</code> must be specified. Otherwise, all entries of each row must sum to 1.</p></dd>


<dt>n_replicates</dt>
<dd><p>The number of bootstrap replicate matrices to generate for each provided relative abundance matrix.</p></dd>


<dt>K</dt>
<dd><p>Optional; an integer specifying the number of mutational signatures included in <code>sig_activity</code>. Default is <code>K=ncol(sig_activity)-length(group)</code>.</p></dd>


<dt>group</dt>
<dd><p>A string (or vector of strings) specifying the name(s) of the column(s) that describes which group(s) each sample belongs to.</p></dd>


<dt>S</dt>
<dd><p>Optional; a K x K similarity matrix with diagonal elements equal to 1 and off-diagonal elements between 0 and 1. Entry <code>S[j,k]</code> is the similarity between signature <code>j</code> and signature <code>k</code>, equaling 1 if the categories are to be treated as identical and equaling 0 if they are to be treated as totally dissimilar. The default value is <code>S = diag(K)</code>.</p></dd>


<dt>normalized</dt>
<dd><p>Optional; should the across-sample variability (Fst) be normalized by its upper bound conditional on the mean activity of the most abundant signature be used as the measure of across-sample variability? Default is <code>normalized = FALSE</code>; use <code>normalized = TRUE</code> to compute normalized Fst. Fst can only be normalized if it is not weighted.</p></dd>


<dt>seed</dt>
<dd><p>Optional; an integer to be used as a random seed for the simulations.</p></dd>


<dt>save_replicates</dt>
<dd><p>Optional; should all of the bootstrap replicate matrices be included in the output? Default is <code>save_replicates = FALSE</code>;  <code>save_replicates = FALSE</code> savea memory when analyzing large datasets.</p></dd>


<dt>alternative</dt>
<dd><p>Optional; do you want to do a one- or two.sided test? Default is <code>alternative = "two.sided"</code>. If you wish to do a one-sided test, specify either <code>alternative = "less"</code> or <code>alternative = "greater"</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A named list containing the following entries:</p><ul><li><p><code>p_values</code>: The probability of observing the observed difference in variability between each pair of groups if there were no difference between groups. Computed as the fraction of bootstrap differences greater than or equal to the observed difference. Depends on what <code>alternative</code> is specified ("greater", "lesser", or "two.sided").</p></li>
<li><p><code>bootstrap_distribution_plot</code>: The distribution of bootstrap replicate differences in each variability value. The observed differences are shown in red. The further the red points are from 0, the more significant the statistical difference between groups.</p></li>
<li><p><code>observed_stats</code>: The observed diversity statistics for the groups.</p></li>
<li><p><code>bootstrap_stats</code>: The bootstrap replicate diversity statistics for the groups.</p></li>
<li><p><code>bootstrap_replicates</code>: The bootstrap replicate matrices, reported only if  <code>save_replicates = TRUE</code>.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Estimate the uncertainty in the across-sample and mean within-sample variability of</span></span></span>
<span class="r-in"><span><span class="co"># mutational signatures in ESCC samples grouped by country</span></span></span>
<span class="r-in"><span><span class="co"># We provide a cosine similarity matrix in order to account for cosine similarity among signatures</span></span></span>
<span class="r-in"><span><span class="va">smoker_boot</span> <span class="op">=</span> <span class="fu">sigboot</span><span class="op">(</span>sig_activity <span class="op">=</span> <span class="va">smoker_sigs_chen</span>, K <span class="op">=</span> <span class="fl">3</span>, n_replicates <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>                    group <span class="op">=</span> <span class="st">"Smoker"</span>, S <span class="op">=</span> <span class="va">smoker_sigs_chen_cossim</span>,</span></span>
<span class="r-in"><span>                    seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We find that there is a strong, significant difference between smokers and non-smokers</span></span></span>
<span class="r-in"><span><span class="co"># in their mean within-sample diversity, but that the difference in across-sample heterogeneity</span></span></span>
<span class="r-in"><span><span class="co"># is less strong</span></span></span>
<span class="r-in"><span><span class="va">smoker_boot</span><span class="op">$</span><span class="va">P_values</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      group_1  group_2      across_sample_heterogeneity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] "Smoker" "Non-smoker" "0.23"                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      mean_within_sample_diversity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] "0.014"                     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can visualize this result by looking at the observed differences between</span></span></span>
<span class="r-in"><span><span class="co"># smokers and non-smokers and the bootstrap replicates, which assume no difference</span></span></span>
<span class="r-in"><span><span class="co"># between these two groups</span></span></span>
<span class="r-in"><span><span class="va">smoker_boot</span><span class="op">$</span><span class="va">bootstrap_distribution_plot</span></span></span>
<span class="r-plt img"><img src="sigboot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Maike Morrison, Nicolas Alcala.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

