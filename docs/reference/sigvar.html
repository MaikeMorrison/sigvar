<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute the within-sample diversity and across-sample heterogeneity of mutational signature activity in one or multiple populations of samples. — sigvar • sigvar</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the within-sample diversity and across-sample heterogeneity of mutational signature activity in one or multiple populations of samples. — sigvar"><meta property="og:description" content="Across-sample variability is quantified by computing the population-genetic statistic Fst across the rows of the signature activity table. This method is based on the R package Fst, which implements an Fst-based assessment of Variability across vectors of relative Abundances. Mean within-sample variability is quantified by computing the mean Gini-Simpson index across all samples. Specify group if your table of signature activities contains mutiple populations of samples which you wish to compare. Specifying S allows sigvar to account for the pairwise cosine similarity among signatures. Specifying w or time allows for uneven weighting of the samples."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sigvar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/geography_incidence_figure.html">sigvar analysis of Mutographs data</a>
    </li>
    <li>
      <a href="../articles/tutorial.html">Introduction to Signature Variability Analysis with sigvar</a>
    </li>
    <li>
      <a href="../articles/carcinogen_figure.html">sigvar analysis of samples with varying carcinogen exposure</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/MaikeMorrison/sigvar/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute the within-sample diversity and across-sample heterogeneity of mutational signature activity in one or multiple populations of samples.</h1>
    <small class="dont-index">Source: <a href="https://github.com/MaikeMorrison/sigvar/blob/HEAD/R/stats_functions.R" class="external-link"><code>R/stats_functions.R</code></a></small>
    <div class="hidden name"><code>sigvar.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Across-sample variability is quantified by computing the population-genetic statistic Fst across the rows of the signature activity table. This method is based on the R package Fst, which implements an Fst-based assessment of Variability across vectors of relative Abundances. Mean within-sample variability is quantified by computing the mean Gini-Simpson index across all samples. Specify <code>group</code> if your table of signature activities contains mutiple populations of samples which you wish to compare. Specifying <code>S</code> allows <code>sigvar</code> to account for the pairwise cosine similarity among signatures. Specifying <code>w</code> or <code>time</code> allows for uneven weighting of the samples.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sigvar</span><span class="op">(</span></span>
<span>  <span class="va">sig_activity</span>,</span>
<span>  K <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  S <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  w <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalized <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sig_activity</dt>
<dd><p>A matrix or data frame with rows containing non-negative entries that sum to 1. Each row represents a sample, each column represents a mutational signature, and each entry represents the abundance of that signature in the sample. If <code>sig_activity</code> contains any metadata, it must be on the left-hand side of the matrix, the right <code>K</code> entries of each row must sum to 1, and <code>K</code> must be specified. Otherwise, all entries of each row must sum to 1.</p></dd>


<dt>K</dt>
<dd><p>Optional; an integer specifying the number of mutational signatures included in <code>sig_activity</code>. Default is <code>K=ncol(sig_activity)</code>.</p></dd>


<dt>group</dt>
<dd><p>Optional; a string (or vector of strings) specifying the name(s) of the column(s) that describes which group(s) each sample belongs to. Use if <code>sig_activity</code> is a single matrix containing multiple groups of samples you wish to compare.</p></dd>


<dt>S</dt>
<dd><p>Optional; a K x K similarity matrix with diagonal elements equal to 1 and off-diagonal elements between 0 and 1. Entry <code>S[j,k]</code> is the similarity between signature <code>j</code> and signature <code>k</code>, equaling 1 if the categories are to be treated as identical and equaling 0 if they are to be treated as totally dissimilar. The default value is <code>S = diag(K)</code>.</p></dd>


<dt>w</dt>
<dd><p>Optional; a vector of length <code>nrow(sig_activity)</code> with non-negative entries that sum to 1. Entry <code>w[i]</code> represents the weight placed on row <code>i</code> in the computation of the mean abundance of each category across rows. The default value is <code>w = rep(1/nrow(sig_activity), nrow(sig_activity))</code>.</p></dd>


<dt>time</dt>
<dd><p>Optional; a string specifying the name of the column that describes the sampling time for each row. Include if you wish to weight the variability measures by the distance between adjacent samples in the matrix.</p></dd>


<dt>normalized</dt>
<dd><p>Optional; should normalized Fst be used as the measure of across-sample variability? Default is <code>normalized = FALSE</code>; use <code>normalized = TRUE</code> to compute normalized Fst. Fst can only be normalized if it is not weighted.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data frame with columns corresponding to the across-sample variability and the mean within-sample variability for the provided samples.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Compute the across-sample and mean within-sample variability of  mutational signatures</span></span></span>
<span class="r-in"><span><span class="co"># in ESCC samples grouped by country</span></span></span>
<span class="r-in"><span><span class="co"># We provide a cosine similarity matrix in order to account for cosine similarity among signatures</span></span></span>
<span class="r-in"><span> <span class="fu">sigvar</span><span class="op">(</span>sig_activity <span class="op">=</span> <span class="va">smoker_sigs_chen</span>, K <span class="op">=</span> <span class="fl">3</span>, group <span class="op">=</span> <span class="st">"Smoker"</span>, S <span class="op">=</span> <span class="va">smoker_sigs_chen_cossim</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(Smoker)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Smoker across_sample_heterogeneity mean_within_sample_diversity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     Smoker                   0.2308918                    0.3425499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Non-smoker                   0.3055201                    0.2810333</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Nicolas Alcala.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

