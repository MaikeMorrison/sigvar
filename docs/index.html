<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quantify and visualize variability of mutational signatures within and across samples • sigvar</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Quantify and visualize variability of mutational signatures within and across samples">
<meta property="og:description" content="This package allows to import mutational signature attribution (a.k.a. exposure) matrices and compute, visualize, and test their variabilities within and across samples.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">sigvar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/geography_incidence_figure.html">sigvar analysis of Mutographs data</a>
    </li>
    <li>
      <a href="articles/tutorial.html">Introduction to Signature Variability Analysis with sigvar</a>
    </li>
    <li>
      <a href="articles/carcinogen_figure.html">sigvar analysis of samples with varying carcinogen exposure</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MaikeMorrison/sigvar/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="sigvar">sigvar<a class="anchor" aria-label="anchor" href="#sigvar"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The R package <em>sigvar</em> implements <strong>sig</strong>nature <strong>var</strong>iability analysis, a framework for the analyis of mutational signature activities within and across cancer samples. The <em>sigvar</em> package contains the following core functions:</p>
<ul>
<li><p><code>sigvar</code>: Conduct signature variability analysis on a data set: compute the within-sample diversity and across-sample heterogeneity of mutational signature activity in one or multiple populations of samples</p></li>
<li><p><code>sigboot</code>: Use bootstrapping to statistically compare the within-sample diversity and across-sample heterogeneity of the mutational signature activity between two or more groups of tumor samples</p></li>
</ul>
<!-- *sigvar* also includes accessory functions for the visualization of mutational signature data, such as:  --><!-- * `plot_SBS_spectrum`: Plot the SBS mutational spectrum of one or more samples or mutational signatures --><!-- * `plot_dots`: Plot the mean mutational signature contributions of one or more groups of samples --><div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of sigvar from <a href="https://github.com/MaikeMorrison/sigvar" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"MaikeMorrison/sigvar"</span><span class="op">)</span></span></code></pre></div>
<p>The package requires packages <code>dplyr</code>, <code>ggplot2</code>, <code>rlang</code>, <code>tidyr</code>, and <code>readr</code>. They will all be installed automatically by the command above. Installation time ranges from 1 to 5 minutes depending on whether dependencies also need to be installed. Run time is expected to be a few minutes on a typical desktop computer.</p>
<!-- See vignettes for detailed examples of using sigvar on real datasets. -->
<p>The package has been tested on R version 4.1.2 on a redhat linux platform and a windows 10 pro platform. The package is available under the MIT license.</p>
<!-- ## Example -->
<!-- This is a basic example which shows you how to import results from SigProfiler and plot the signature attributions: -->
<!-- ```{r example} -->
<!-- library(sigvar) -->
<!-- SPfolder = system.file("extdata", "example_SigProfiler_results", package = "sigvar") -->
<!-- Qlist = import_SigProfiler(SPfolder) -->
<!-- plot_dots(Qlist[[1]]) -->
<!-- ``` -->
</div>
<div class="section level2">
<h2 id="example-analysis">Example analysis<a class="anchor" aria-label="anchor" href="#example-analysis"></a>
</h2>
<p>In this example, we apply signature variability analysis (SVA) to data from <a href="https://www.nature.com/articles/s41588-021-00928-6" class="external-link">Moody et al. (2021)</a>. This data set contains 552 esophageal squamous cell carcinoma (ESCC) samples collected across eight countries which vary dramatically in their incidence of ESCC. Moody et al. (2021) reported the activities of 43 SBS, DBS, and ID mutational signatures for each sample.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MaikeMorrison/sigvar" class="external-link">sigvar</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ESCC_sig_activity</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 x 46</span></span>
<span><span class="co">#&gt;   Country Incidence_Level Sample    SBS1  SBS2  SBS3  SBS4  SBS5  SBS8 SBS10a</span></span>
<span><span class="co">#&gt;   &lt;ord&gt;   &lt;chr&gt;           &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Kenya   High            PD37727a 0.148 0         0     0     0     0      0</span></span>
<span><span class="co">#&gt; 2 Kenya   High            PD37728a 0.156 0.207     0     0     0     0      0</span></span>
<span><span class="co">#&gt; 3 Kenya   High            PD37729a 0     0.196     0     0     0     0      0</span></span>
<span><span class="co">#&gt; 4 Kenya   High            PD37730a 0.165 0.234     0     0     0     0      0</span></span>
<span><span class="co">#&gt; 5 Kenya   High            PD37731a 0     0.317     0     0     0     0      0</span></span>
<span><span class="co">#&gt; 6 Kenya   High            PD37733a 0.134 0.212     0     0     0     0      0</span></span>
<span><span class="co">#&gt; # i 36 more variables: SBS10b &lt;dbl&gt;, SBS12 &lt;dbl&gt;, SBS13 &lt;dbl&gt;, SBS14 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SBS15 &lt;dbl&gt;, SBS16 &lt;dbl&gt;, SBS17a &lt;dbl&gt;, SBS17b &lt;dbl&gt;, SBS18 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SBS20 &lt;dbl&gt;, SBS22 &lt;dbl&gt;, SBS23 &lt;dbl&gt;, SBS25 &lt;dbl&gt;, SBS28 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SBS30 &lt;dbl&gt;, SBS33 &lt;dbl&gt;, SBS34 &lt;dbl&gt;, SBS39 &lt;dbl&gt;, SBS40 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   SBS44 &lt;dbl&gt;, SBS288P &lt;dbl&gt;, DBS2 &lt;dbl&gt;, DBS4 &lt;dbl&gt;, DBS6 &lt;dbl&gt;, DBS9 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   DBS78D &lt;dbl&gt;, ID1 &lt;dbl&gt;, ID2 &lt;dbl&gt;, ID3 &lt;dbl&gt;, ID4 &lt;dbl&gt;, ID6 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   ID8 &lt;dbl&gt;, ID9 &lt;dbl&gt;, ID11 &lt;dbl&gt;, ID14 &lt;dbl&gt;, ID17 &lt;dbl&gt;</span></span></code></pre></div>
<p>Each row of this data set reports the relative activity of each mutational signature for one sample. Because we are analyzing relative signature activities, each row sums to 1.</p>
<div class="section level3">
<h3 id="signature-variability-analysis-can-be-conducted-in-one-line-of-code">Signature variability analysis can be conducted in one line of code:<a class="anchor" aria-label="anchor" href="#signature-variability-analysis-can-be-conducted-in-one-line-of-code"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sva</span> <span class="op">=</span> <span class="fu"><a href="reference/sigvar.html">sigvar</a></span><span class="op">(</span>sig_activity <span class="op">=</span> <span class="va">ESCC_sig_activity</span>, K <span class="op">=</span> <span class="fl">43</span>, group <span class="op">=</span> <span class="st">"Country"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">sva</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="14%">
<col width="42%">
<col width="43%">
</colgroup>
<thead><tr class="header">
<th align="left">Country</th>
<th align="right">across_sample_heterogeneity</th>
<th align="right">mean_within_sample_diversity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Kenya</td>
<td align="right">0.1778148</td>
<td align="right">0.7011235</td>
</tr>
<tr class="even">
<td align="left">Iran</td>
<td align="right">0.2126657</td>
<td align="right">0.6705337</td>
</tr>
<tr class="odd">
<td align="left">Tanzania</td>
<td align="right">0.1606487</td>
<td align="right">0.6976021</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="right">0.1684907</td>
<td align="right">0.6908129</td>
</tr>
<tr class="odd">
<td align="left">Japan</td>
<td align="right">0.2234567</td>
<td align="right">0.6525885</td>
</tr>
<tr class="even">
<td align="left">Malawi</td>
<td align="right">0.1867597</td>
<td align="right">0.6813242</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="right">0.2344654</td>
<td align="right">0.6446411</td>
</tr>
<tr class="even">
<td align="left">UK</td>
<td align="right">0.2143285</td>
<td align="right">0.6335159</td>
</tr>
</tbody>
</table>
<p>Signature variability analysis quantifies both the mean signature diversity within each sample, as well as the heterogeneity in signature activities across samples. Both variability statistics range between 0 and 1.</p>
<p>If we add to our SVA results a column corresponding to the incidence of each country, we are able to determine if signature heterogeneity or diversity are associated with ESCC incidence.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sva_incidence</span> <span class="op">=</span> <span class="va">ESCC_sig_activity</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html" class="external-link">transmute</a></span><span class="op">(</span>Country <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Country</span><span class="op">)</span>, </span>
<span>            <span class="va">Incidence_Level</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">distinct</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join</a></span><span class="op">(</span><span class="va">sva</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">sva_incidence</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="11%">
<col width="19%">
<col width="33%">
<col width="34%">
</colgroup>
<thead><tr class="header">
<th align="left">Country</th>
<th align="left">Incidence_Level</th>
<th align="right">across_sample_heterogeneity</th>
<th align="right">mean_within_sample_diversity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Kenya</td>
<td align="left">High</td>
<td align="right">0.1778148</td>
<td align="right">0.7011235</td>
</tr>
<tr class="even">
<td align="left">Iran</td>
<td align="left">High</td>
<td align="right">0.2126657</td>
<td align="right">0.6705337</td>
</tr>
<tr class="odd">
<td align="left">Tanzania</td>
<td align="left">High</td>
<td align="right">0.1606487</td>
<td align="right">0.6976021</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="left">High</td>
<td align="right">0.1684907</td>
<td align="right">0.6908129</td>
</tr>
<tr class="odd">
<td align="left">Japan</td>
<td align="left">Low</td>
<td align="right">0.2234567</td>
<td align="right">0.6525885</td>
</tr>
<tr class="even">
<td align="left">Malawi</td>
<td align="left">High</td>
<td align="right">0.1867597</td>
<td align="right">0.6813242</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="left">Low</td>
<td align="right">0.2344654</td>
<td align="right">0.6446411</td>
</tr>
<tr class="even">
<td align="left">UK</td>
<td align="left">Low</td>
<td align="right">0.2143285</td>
<td align="right">0.6335159</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sva_incidence</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mean_within_sample_diversity</span>, </span>
<span>           y <span class="op">=</span> <span class="va">across_sample_heterogeneity</span>, </span>
<span>           color <span class="op">=</span> <span class="va">Incidence_Level</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">Country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png"><!-- --></p>
<p>We see that high-ESCC-incidence countries have more within-sample signature diversity and less across-sample heterogeneity than low-incidence countries.</p>
<!-- ```{r} -->
<!-- sva_incidence %>%  -->
<!--   tidyr::pivot_longer(cols = c(across_sample_heterogeneity, mean_within_sample_diversity), -->
<!--                       names_to = "Variability_statistic") %>% -->
<!-- ggplot(aes(x = Incidence_Level, y = value, fill = Incidence_Level)) +  -->
<!--   geom_violin(color = NA, alpha = 0.75) + -->
<!--   ggbeeswarm::geom_beeswarm() + -->
<!--   ggpubr::stat_compare_means(method = "t.test") +  -->
<!--   facet_wrap(~ Variability_statistic, scales = "free") + -->
<!--   theme_bw() -->
<!-- ``` -->
<p>Note that this difference in diversity is missed when we analyze only country-level mean signature activities:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_dots.html">plot_dots</a></span><span class="op">(</span>sig_activity <span class="op">=</span> <span class="va">ESCC_sig_activity</span>, </span>
<span>          K <span class="op">=</span> <span class="fl">43</span>, group <span class="op">=</span> <span class="st">"Country"</span>, </span>
<span>          facet <span class="op">=</span> <span class="st">"Incidence_Level"</span>, </span>
<span>          pivot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png"><!-- --></p>
<p>We use bootstrapping (<code>sigboot</code>) to statistically compare the signature diversity or heterogeneity of cancer samples. For example, the below code compares SVA results among the low-incidence countries.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low_inc_boot</span> <span class="op">=</span> <span class="fu"><a href="reference/sigboot.html">sigboot</a></span><span class="op">(</span>sig_activity <span class="op">=</span> <span class="va">ESCC_sig_activity</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Incidence_Level</span> <span class="op">==</span> <span class="st">"Low"</span><span class="op">)</span>,</span>
<span>                       K <span class="op">=</span> <span class="fl">43</span>, </span>
<span>                       group <span class="op">=</span> <span class="st">"Country"</span>,</span>
<span>                       n_replicates <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                       seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>In short, the bootstrapping algorithm involves taking a pair of populations (for example, Japan and Brazil), scrambling their samples up many times (with some samples randomly duplicated and others omitted), conducting SVA on the scrambled populations, and then comparing the difference between SVA results for each scrambled population (black dots) to the true difference (red dots). We can see in the below plot that the red dots fall in the middle of the black dots, suggesting that there is not a significant difference in SVA results between Japan and Brazil.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low_inc_boot</span><span class="op">$</span><span class="va">bootstrap_distribution_plot</span><span class="op">$</span><span class="va">`Japan--Brazil`</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png"><!-- --></p>
<p>This lack of significance is quantified by the two-sided P-value comparing each pair of countries:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">low_inc_boot</span><span class="op">$</span><span class="va">P_values</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">pooled_diversity</span><span class="op">)</span></span>
<span><span class="co">#&gt;   group_1 group_2 across_sample_heterogeneity mean_within_sample_diversity</span></span>
<span><span class="co">#&gt; 1   Japan  Brazil                        0.77                         0.78</span></span>
<span><span class="co">#&gt; 2   Japan      UK                        0.91                         0.66</span></span>
<span><span class="co">#&gt; 3  Brazil      UK                        0.71                         0.81</span></span></code></pre></div>
<p>However, suppose we compare a high-incidence country like Kenya to a low-incidence country like Japan:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison_boot</span> <span class="op">=</span> <span class="fu"><a href="reference/sigboot.html">sigboot</a></span><span class="op">(</span>sig_activity <span class="op">=</span> <span class="va">ESCC_sig_activity</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Japan"</span>, <span class="st">"Kenya"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       K <span class="op">=</span> <span class="fl">43</span>, </span>
<span>                       group <span class="op">=</span> <span class="st">"Country"</span>,</span>
<span>                       n_replicates <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                       seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comparison_boot</span><span class="op">$</span><span class="va">bootstrap_distribution_plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png"><!-- --></p>
<p>We see that, for the SVA statistics <code>across_sample_heterogeneity</code> and <code>mean_within_sample_diversity</code>, the red dots fall far outside of the range of most of the black dots, suggesting that there is a significant difference in SVA results between Kenya and Japan. This difference is reflected by low two-sided P-values:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison_boot</span><span class="op">$</span><span class="va">P_values</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">pooled_diversity</span><span class="op">)</span></span>
<span><span class="co">#&gt;   group_1 group_2 across_sample_heterogeneity mean_within_sample_diversity</span></span>
<span><span class="co">#&gt; 1   Kenya   Japan                        0.08                        &lt;0.01</span></span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/MaikeMorrison/sigvar/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/MaikeMorrison/sigvar/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing sigvar</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Maike Morrison <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-0430-1401" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Nicolas Alcala <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-5961-5064" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Maike Morrison, Nicolas Alcala.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
